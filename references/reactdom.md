# createRoot

`createRoot` lets you create a root to display React components inside a browser DOM node.

```javascript
const root = createRoot(domNode, options?)
```

## Reference

### createRoot(domNode, options?)

Call `createRoot` to create a React root for displaying content inside a browser DOM element.

```javascript
import { createRoot } from 'react-dom/client';

const domNode = document.getElementById('root');
const root = createRoot(domNode);
```

React will create a root for the `domNode`, and take over managing the DOM inside it. After you've created a root, you need to call `root.render` to display a React component inside of it:

```javascript
root.render(<App />);
```

An app fully built with React will usually only have one `createRoot` call for its root component. A page that uses "sprinkles" of React for parts of the page may have as many separate roots as needed.

#### Parameters

- `domNode`: A DOM element. React will create a root for this DOM element and allow you to call functions on the root, such as render to display rendered React content.
- `options`: (Optional) An object with options for this React root:
  - `onCaughtError` (Canary only): Callback called when React catches an error in an Error Boundary. Called with the error caught by the Error Boundary, and an `errorInfo` object containing the `componentStack`.
  - `onUncaughtError` (Canary only): Callback called when an error is thrown and not caught by an Error Boundary. Called with the error that was thrown, and an `errorInfo` object containing the `componentStack`.
  - `onRecoverableError`: Callback called when React automatically recovers from errors. Called with an error React throws, and an `errorInfo` object containing the `componentStack`.
  - `identifierPrefix`: A string prefix React uses for IDs generated by `useId`. Useful to avoid conflicts when using multiple roots on the same page.

#### Returns

`createRoot` returns an object with two methods: `render` and `unmount`.

#### Caveats

- If your app is server-rendered, using `createRoot()` is not supported. Use `hydrateRoot()` instead.
- You'll likely have only one `createRoot` call in your app. If you use a framework, it might do this call for you.
- When you want to render a piece of JSX in a different part of the DOM tree that isn't a child of your component (for example, a modal or a tooltip), use `createPortal` instead of `createRoot`.

### root.render(reactNode)

Call `root.render` to display a piece of JSX ("React node") into the React root's browser DOM node.

```javascript
root.render(<App />);
```

React will display `<App />` in the root, and take over managing the DOM inside it.

#### Parameters

- `reactNode`: A React node that you want to display. This will usually be a piece of JSX like `<App />`, but you can also pass a React element constructed with `createElement()`, a string, a number, `null`, or `undefined`.

#### Returns

`root.render` returns `undefined`.

#### Caveats

The first time you call `root.render`, React will clear all the existing HTML content inside the React root before rendering the React component into it.

If your root's DOM node contains HTML generated by React on the server or during the build, use `hydrateRoot()` instead, which attaches the event handlers to the existing HTML.

### root.unmount()

Call `root.unmount` to destroy a rendered tree inside a React root.

```javascript
root.unmount();
```

#### Usage

An app fully built with React will usually not have any calls to `root.unmount`. This is mostly useful if your React root's DOM node (or any of its ancestors) may get removed from the DOM by some other code.

#### Effects

- Unmounts all components in the root
- "Detaches" React from the root DOM node
- Removes event handlers and state in the tree
- Cleans up global resources

#### Caveats

- Once you call `root.unmount` you cannot call `root.render` again on the same root
- Attempting to call `root.render` on an unmounted root will throw a "Cannot update an unmounted root" error
- You can create a new root for the same DOM node after the previous root has been unmounted

## Usage Examples

### Rendering an App Fully Built with React

```javascript
import { createRoot } from 'react-dom/client';

const root = createRoot(document.getElementById('root'));
root.render(<App />);
```

> **Note**: When your HTML is empty, the user sees a blank page until the app's JavaScript code loads and runs. To solve this, consider using server-side rendering (SSR) or static site generation (SSG).

### Rendering a Page Partially Built with React

```javascript
import { createRoot } from 'react-dom/client';
import { Comments, Navigation } from './Components.js';

const navRoot = createRoot(document.getElementById('navigation'));
navRoot.render(<Navigation />);

const commentRoot = createRoot(document.getElementById('comments'));
commentRoot.render(<Comments />);
```

### Dynamic DOM Node Creation

```javascript
const domNode = document.createElement('div');
const root = createRoot(domNode);
root.render(<Comment />);
document.body.appendChild(domNode);
```

## Error Handling

### Uncaught Errors (Canary)

```javascript
const root = createRoot(document.getElementById('root'), {
  onUncaughtError: (error, errorInfo) => {
    console.error('Uncaught error', error, errorInfo.componentStack);
  }
});
```

### Error Boundary Errors (Canary)

```javascript
const root = createRoot(document.getElementById('root'), {
  onCaughtError: (error, errorInfo) => {
    console.error('Caught error', error, errorInfo.componentStack);
  }
});
```

### Recoverable Errors

```javascript
const root = createRoot(document.getElementById('root'), {
  onRecoverableError: (error, errorInfo) => {
    console.error('Recoverable error', error, error.cause, errorInfo.componentStack);
  }
});
```

## Troubleshooting

### Common Issues

1. **Nothing Displayed**: Ensure you've called `root.render(<App />)` after creating the root.

2. **Second Argument Error**:
```javascript
// ❌ Wrong: root.render only takes one argument
root.render(App, {onUncaughtError});

// ✅ Correct: pass options to createRoot
const root = createRoot(container, {onUncaughtError});
root.render(<App />);
```

3. **"Target container is not a DOM element"**: Verify your DOM node selection:
```javascript
const domNode = document.getElementById('root');
console.log(domNode); // Debug the node
const root = createRoot(domNode);
```

4. **"Functions are not valid as a React child"**:
```javascript
// ❌ Wrong: App is a function
root.render(App);

// ✅ Correct: <App /> is a component
root.render(<App />);
```

5. **Server-rendered HTML Recreation**: Use `hydrateRoot` instead of `createRoot` for server-rendered applications:
```javascript
import { hydrateRoot } from 'react-dom/client';
hydrateRoot(document.getElementById('root'), <App />);
```
# Getting Started with React

## Setting Up React

To use React in your newly created project, you need to load two React scripts from unpkg.com:

- `react`: The core React library
- `react-dom`: Provides DOM-specific methods for using React with the DOM

Here's the initial HTML setup:

```html
<html>
  <body>
    <div id="app"></div>
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script type="text/javascript">
      const app = document.getElementById('app');
      const header = document.createElement('h1');
      const text = 'Develop. Preview. Ship.';
      const headerContent = document.createTextNode(text);
      header.appendChild(headerContent);
      app.appendChild(header);
    </script>
  </body>
</html>
```

## Using React Components

Instead of directly manipulating the DOM with plain JavaScript, React provides a more declarative approach. You can use `ReactDOM.createRoot()` to create a root for displaying React components, and `root.render()` to render React code to the DOM:

```html
<html>
  <body>
    <div id="app"></div>
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script>
      const app = document.getElementById('app');
      const root = ReactDOM.createRoot(app);
      root.render(<h1>Develop. Preview. Ship.</h1>);
    </script>
  </body>
</html>
```

However, running this code will result in a syntax error because browsers don't understand JSX syntax.

## Understanding JSX

JSX is a syntax extension for JavaScript that allows you to describe UI in an HTML-like syntax. While it's powerful and intuitive, browsers need a JavaScript compiler like Babel to transform JSX code into regular JavaScript.

### Adding Babel

To use Babel in your project:

1. Add the Babel script:
```html
<script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
```

2. Change your script type to `text/jsx`:

```html
<html>
  <body>
    <div id="app"></div>
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <!-- Babel Script -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script type="text/jsx">
      const domNode = document.getElementById('app');
      const root = ReactDOM.createRoot(domNode);
      root.render(<h1>Develop. Preview. Ship.</h1>);
    </script>
  </body>
</html>
```

## Comparing Approaches

### Declarative React Approach:
```jsx
const domNode = document.getElementById("app");
const root = ReactDOM.createRoot(domNode);
root.render(<h1>Develop. Preview. Ship.</h1>);
```

### Imperative JavaScript Approach:
```javascript
const app = document.getElementById('app');
const header = document.createElement('h1');
const text = 'Develop. Preview. Ship.';
const headerContent = document.createTextNode(text);
header.appendChild(headerContent);
app.appendChild(header);
```

React's declarative approach helps reduce repetitive code and provides reusable components for building UIs.

## Essential JavaScript for React

While you can learn JavaScript and React simultaneously, familiarity with these JavaScript concepts will help you learn React more effectively:

- Functions and Arrow Functions
- Objects
- Arrays and array methods
- Destructuring
- Template literals
- Ternary Operators
- ES Modules and Import/Export Syntax

## Additional Resources

For deeper understanding of React's UI updates:
- UI trees
- Writing markup with JSX
- react-dom/server sections in the React Documentation

## Note

You don't need to fully understand React's internal UI update mechanisms to start using it. Focus on building and learning as you go. Even if you're not yet proficient in JavaScript, you can begin building with React and improve your skills along the way.
